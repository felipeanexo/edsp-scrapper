<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard EDSP - An√°lise Avan√ßada das Escolas de S√£o Paulo</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-chart-treemap@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-chart-sankey@2"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            opacity: 1;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.2rem;
            opacity: 1;
        }

        .controls-panel {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .controls-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .control-group {
            display: flex;
            flex-direction: column;
        }

        .control-group label {
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
        }

        .control-group select, .control-group input {
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .control-group select:focus, .control-group input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .filter-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 20px;
            background: #667eea;
            color: white;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
        }

        .filter-btn:hover {
            background: #5a6fd8;
            transform: translateY(-2px);
        }

        .filter-btn.active {
            background: #764ba2;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .main-charts {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .chart-container {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            position: relative;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .chart-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
        }

        .chart-actions {
            display: flex;
            gap: 10px;
        }

        .action-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 6px;
            background: #f8f9fa;
            color: #333;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
        }

        .action-btn:hover {
            background: #667eea;
            color: white;
        }

        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .stats-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            text-align: center;
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 10px;
        }

        .stat-label {
            font-size: 1rem;
            color: #666;
            margin-bottom: 15px;
        }

        .stat-change {
            font-size: 0.9rem;
            color: #28a745;
        }

        .data-table {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .table-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
        }

        .table-search {
            padding: 8px 12px;
            border: 2px solid #e1e5e9;
            border-radius: 6px;
            width: 200px;
        }

        .table-container {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e1e5e9;
        }

        th {
            background: #f8f9fa;
            font-weight: 600;
            color: #333;
        }

        tr:hover {
            background: #f8f9fa;
        }

        .trend-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .trend-up { background: #28a745; }
        .trend-down { background: #dc3545; }
        .trend-stable { background: #ffc107; }

        .footer {
            text-align: center;
            color: white;
            padding: 30px 0;
            opacity: 1;
        }

        .footer p {
            margin-bottom: 15px;
            opacity: 1;
        }

        .footer a {
            color: white;
            text-decoration: none;
            margin: 0 10px;
            opacity: 1;
        }

        .footer a:hover {
            text-decoration: underline;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 40px;
            background: white;
            border-radius: 12px;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @media (max-width: 1200px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .main-charts {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .controls-grid {
                grid-template-columns: 1fr;
            }
        }

        .tooltip {
            position: absolute;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
            pointer-events: none;
            z-index: 1000;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-chart-line"></i> Dashboard EDSP Avan√ßado</h1>
            <p>An√°lise Profissional das Escolas de S√£o Paulo</p>
        </div>

        <div class="controls-panel">
            <div class="controls-grid">
                <div class="control-group">
                    <label><i class="fas fa-filter"></i> Diretoria de Ensino</label>
                    <select id="directorateFilter">
                        <option value="">Todas as Diretorias</option>
                        <option value="SUL 1">SUL 1</option>
                        <option value="SUL 2">SUL 2</option>
                        <option value="SUL 3">SUL 3</option>
                        <option value="LESTE 1">LESTE 1</option>
                        <option value="LESTE 2">LESTE 2</option>
                        <option value="NORTE 1">NORTE 1</option>
                        <option value="NORTE 2">NORTE 2</option>
                        <option value="OESTE 1">OESTE 1</option>
                        <option value="OESTE 2">OESTE 2</option>
                    </select>
                </div>
                
                <div class="control-group">
                    <label><i class="fas fa-graduation-cap"></i> Classifica√ß√£o</label>
                    <select id="classificationFilter">
                        <option value="">Todas as Classifica√ß√µes</option>
                        <option value="PEI">PEI</option>
                        <option value="EE">EE</option>
                    </select>
                </div>
                
                <div class="control-group">
                    <label><i class="fas fa-star"></i> Faixa IDEB</label>
                    <select id="idebFilter">
                        <option value="">Todas as Faixas</option>
                        <option value="0-2">0-2 (Baixo)</option>
                        <option value="2-4">2-4 (Regular)</option>
                        <option value="4-6">4-6 (Bom)</option>
                        <option value="6-8">6-8 (Muito Bom)</option>
                        <option value="8-10">8-10 (Excelente)</option>
                    </select>
                </div>
                
                <div class="control-group">
                    <label><i class="fas fa-users"></i> Faixa de Alunos</label>
                    <select id="studentsFilter">
                        <option value="">Todas as Faixas</option>
                        <option value="0-100">0-100 alunos</option>
                        <option value="100-500">100-500 alunos</option>
                        <option value="500-1000">500-1000 alunos</option>
                        <option value="1000+">1000+ alunos</option>
                    </select>
                </div>
            </div>
            
            <div class="filter-buttons">
                <button class="filter-btn active" data-filter="all">Todos os Dados</button>
                <button class="filter-btn" data-filter="top">Top 10 IDEB</button>
                <button class="filter-btn" data-filter="bottom">Menores IDEB</button>
                <button class="filter-btn" data-filter="large">Escolas Grandes</button>
                <button class="filter-btn" data-filter="small">Escolas Pequenas</button>
                <button class="filter-btn" data-filter="pei">Apenas PEI</button>
                <button class="filter-btn" data-filter="ee">Apenas EE</button>
            </div>
        </div>

        <div class="dashboard-grid">
            <div class="main-charts">
                <div class="chart-container">
                    <div class="chart-header">
                        <div class="chart-title">
                            <i class="fas fa-chart-pie"></i> Distribui√ß√£o por Classifica√ß√£o
                        </div>
                        <div class="chart-actions">
                            <button class="action-btn" onclick="exportChart('classificationChart')">
                                <i class="fas fa-download"></i>
                            </button>
                            <button class="action-btn" onclick="toggleFullscreen('classificationChart')">
                                <i class="fas fa-expand"></i>
                            </button>
                        </div>
                    </div>
                    <canvas id="classificationChart"></canvas>
                </div>
                
                <div class="chart-container">
                    <div class="chart-header">
                        <div class="chart-title">
                            <i class="fas fa-chart-bar"></i> Distribui√ß√£o IDEB - Anos Finais
                        </div>
                        <div class="chart-actions">
                            <button class="action-btn" onclick="exportChart('idebChart')">
                                <i class="fas fa-download"></i>
                            </button>
                            <button class="action-btn" onclick="toggleFullscreen('idebChart')">
                                <i class="fas fa-expand"></i>
                            </button>
                        </div>
                    </div>
                    <canvas id="idebChart"></canvas>
                </div>
                
                <div class="chart-container">
                    <div class="chart-header">
                        <div class="chart-title">
                            <i class="fas fa-chart-line"></i> Evolu√ß√£o IDEB por Regi√£o
                        </div>
                        <div class="chart-actions">
                            <button class="action-btn" onclick="exportChart('evolutionChart')">
                                <i class="fas fa-download"></i>
                            </button>
                            <button class="action-btn" onclick="toggleFullscreen('evolutionChart')">
                                <i class="fas fa-expand"></i>
                            </button>
                        </div>
                    </div>
                    <canvas id="evolutionChart"></canvas>
                </div>
                
                <div class="chart-container">
                    <div class="chart-header">
                        <div class="chart-title">
                            <i class="fas fa-chart-area"></i> Distribui√ß√£o de Alunos por Idade
                        </div>
                        <div class="chart-actions">
                            <button class="action-btn" onclick="exportChart('studentsChart')">
                                <i class="fas fa-download"></i>
                            </button>
                            <button class="action-btn" onclick="toggleFullscreen('studentsChart')">
                                <i class="fas fa-expand"></i>
                            </button>
                        </div>
                    </div>
                    <canvas id="studentsChart"></canvas>
                </div>
            </div>
            
            <div class="sidebar">
                <div class="stats-card">
                    <div class="stat-value" id="totalSchools">5,575</div>
                    <div class="stat-label">Total de Escolas</div>
                    <div class="stat-change">
                        <span class="trend-indicator trend-up"></span>
                        +2.3% vs m√™s anterior
                    </div>
                </div>
                
                <div class="stats-card">
                    <div class="stat-value" id="avgIdeb">5.2</div>
                    <div class="stat-label">IDEB M√©dio</div>
                    <div class="stat-change">
                        <span class="trend-indicator trend-up"></span>
                        +0.3 vs ano anterior
                    </div>
                </div>
                
                <div class="stats-card">
                    <div class="stat-value" id="totalStudents">610K</div>
                    <div class="stat-label">Total de Alunos</div>
                    <div class="stat-change">
                        <span class="trend-indicator trend-stable"></span>
                        +0.1% vs m√™s anterior
                    </div>
                </div>
                
                <div class="stats-card">
                    <div class="stat-value" id="successRate">100%</div>
                    <div class="stat-label">Taxa de Sucesso</div>
                    <div class="stat-change">
                        <span class="trend-indicator trend-up"></span>
                        +5% vs execu√ß√£o anterior
                    </div>
                </div>
            </div>
        </div>

        <div class="data-table">
            <div class="table-header">
                <div class="table-title">
                    <i class="fas fa-table"></i> Dados Detalhados das Escolas
                </div>
                <input type="text" class="table-search" placeholder="Buscar escolas..." id="tableSearch">
            </div>
            <div class="table-container">
                <table id="schoolsTable">
                    <thead>
                        <tr>
                            <th>Escola</th>
                            <th>Classifica√ß√£o</th>
                            <th>Diretoria</th>
                            <th>IDEB Anos Finais</th>
                            <th>IDEB Ensino M√©dio</th>
                            <th>Total Alunos</th>
                            <th>Total Turmas</th>
                            <th>Salas de Aula</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        <!-- Dados ser√£o inseridos via JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>

        <div class="footer">
            <p>¬© 2025 Dashboard EDSP Avan√ßado - Desenvolvido com ‚ù§Ô∏è por <strong>Felipe Anexo</strong> para a educa√ß√£o de S√£o Paulo</p>
            <div style="margin-top: 10px;">
                <a href="https://github.com/felipeanexo" target="_blank" style="color: white; text-decoration: none; margin: 0 10px;">üêô GitHub</a>
                <a href="https://linkedin.com/in/felipeversiane" target="_blank" style="color: white; text-decoration: none; margin: 0 10px;">üíº LinkedIn</a>
            </div>
        </div>
    </div>

    <script>
        // Dados simulados baseados em estat√≠sticas reais
        const mockData = {
            schools: [
                { name: "16 DE JULHO", classification: "PEI", directorate: "SUL 1", idebFinal: 4.6, idebHigh: 5.1, students: 361, classes: 12, classrooms: 15, status: "Ativa" },
                { name: "ESCOLA ESTADUAL PAULISTA", classification: "EE", directorate: "LESTE 1", idebFinal: 5.8, idebHigh: 6.2, students: 850, classes: 25, classrooms: 20, status: "Ativa" },
                { name: "INSTITUTO EDUCACIONAL", classification: "PEI", directorate: "NORTE 1", idebFinal: 6.5, idebHigh: 7.1, students: 1200, classes: 35, classrooms: 28, status: "Ativa" },
                { name: "COLEGIO S√ÉO PAULO", classification: "EE", directorate: "OESTE 1", idebFinal: 4.2, idebHigh: 4.8, students: 650, classes: 18, classrooms: 16, status: "Ativa" },
                { name: "ESCOLA MUNICIPAL", classification: "PEI", directorate: "SUL 2", idebFinal: 7.1, idebHigh: 7.8, students: 450, classes: 15, classrooms: 12, status: "Ativa" },
                { name: "INSTITUTO T√âCNICO", classification: "EE", directorate: "LESTE 2", idebFinal: 5.3, idebHigh: 5.9, students: 980, classes: 30, classrooms: 25, status: "Ativa" },
                { name: "COLEGIO PARTICULAR", classification: "PEI", directorate: "NORTE 2", idebFinal: 6.8, idebHigh: 7.3, students: 720, classes: 22, classrooms: 18, status: "Ativa" },
                { name: "ESCOLA ESTADUAL CENTRAL", classification: "EE", directorate: "OESTE 2", idebFinal: 4.9, idebHigh: 5.4, students: 1100, classes: 32, classrooms: 26, status: "Ativa" }
            ]
        };

        let filteredData = [...mockData.schools];
        let charts = {};

        // Inicializar dashboard
        document.addEventListener('DOMContentLoaded', function() {
            initializeCharts();
            updateTable();
            setupEventListeners();
        });

        function initializeCharts() {
            // Gr√°fico de Classifica√ß√£o
            charts.classification = new Chart(document.getElementById('classificationChart'), {
                type: 'doughnut',
                data: {
                    labels: ['PEI', 'EE'],
                    datasets: [{
                        data: [3200, 2375],
                        backgroundColor: ['#667eea', '#764ba2'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: { color: '#333', font: { size: 12 } }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': ' + context.parsed + ' escolas';
                                }
                            }
                        }
                    }
                }
            });

            // Gr√°fico IDEB
            charts.ideb = new Chart(document.getElementById('idebChart'), {
                type: 'bar',
                data: {
                    labels: ['0-2', '2-4', '4-6', '6-8', '8-10'],
                    datasets: [{
                        label: 'Escolas',
                        data: [450, 1200, 1800, 1500, 625],
                        backgroundColor: 'rgba(102, 126, 234, 0.8)',
                        borderColor: '#667eea',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.parsed + ' escolas';
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: { color: '#333' }
                        },
                        x: {
                            ticks: { color: '#333' }
                        }
                    }
                }
            });

            // Gr√°fico de Evolu√ß√£o
            charts.evolution = new Chart(document.getElementById('evolutionChart'), {
                type: 'line',
                data: {
                    labels: ['2019', '2020', '2021', '2022', '2023', '2024'],
                    datasets: [
                        {
                            label: 'SUL 1',
                            data: [4.8, 5.1, 5.3, 5.5, 5.7, 5.9],
                            borderColor: '#667eea',
                            backgroundColor: 'rgba(102, 126, 234, 0.1)',
                            tension: 0.4
                        },
                        {
                            label: 'LESTE 1',
                            data: [4.5, 4.8, 5.0, 5.2, 5.4, 5.6],
                            borderColor: '#764ba2',
                            backgroundColor: 'rgba(118, 75, 162, 0.1)',
                            tension: 0.4
                        },
                        {
                            label: 'NORTE 1',
                            data: [4.2, 4.5, 4.7, 4.9, 5.1, 5.3],
                            borderColor: '#f093fb',
                            backgroundColor: 'rgba(240, 147, 251, 0.1)',
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: { color: '#333', font: { size: 12 } }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            min: 4,
                            max: 6,
                            ticks: { color: '#333' }
                        },
                        x: {
                            ticks: { color: '#333' }
                        }
                    }
                }
            });

            // Gr√°fico de Alunos
            charts.students = new Chart(document.getElementById('studentsChart'), {
                type: 'pie',
                data: {
                    labels: ['06-10 anos', '11-14 anos', '15-17 anos', '18+ anos'],
                    datasets: [{
                        data: [85000, 320000, 180000, 25000],
                        backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: { color: '#333', font: { size: 12 } }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': ' + context.parsed.toLocaleString() + ' alunos';
                                }
                            }
                        }
                    }
                }
            });
        }

        function setupEventListeners() {
            // Filtros
            document.getElementById('directorateFilter').addEventListener('change', filterData);
            document.getElementById('classificationFilter').addEventListener('change', filterData);
            document.getElementById('idebFilter').addEventListener('change', filterData);
            document.getElementById('studentsFilter').addEventListener('change', filterData);

            // Bot√µes de filtro r√°pido
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    applyQuickFilter(this.dataset.filter);
                });
            });

            // Busca na tabela
            document.getElementById('tableSearch').addEventListener('input', function() {
                filterTable(this.value);
            });
        }

        function filterData() {
            const directorate = document.getElementById('directorateFilter').value;
            const classification = document.getElementById('classificationFilter').value;
            const idebRange = document.getElementById('idebFilter').value;
            const studentsRange = document.getElementById('studentsFilter').value;

            filteredData = mockData.schools.filter(school => {
                let match = true;

                if (directorate && school.directorate !== directorate) match = false;
                if (classification && school.classification !== classification) match = false;
                
                if (idebRange) {
                    const [min, max] = idebRange.split('-').map(Number);
                    if (school.idebFinal < min || school.idebFinal > max) match = false;
                }
                
                if (studentsRange) {
                    const [min, max] = studentsRange.split('-').map(Number);
                    if (max) {
                        if (school.students < min || school.students > max) match = false;
                    } else {
                        if (school.students < min) match = false;
                    }
                }

                return match;
            });

            updateCharts();
            updateTable();
            updateStats();
        }

        function applyQuickFilter(filter) {
            switch(filter) {
                case 'top':
                    filteredData = mockData.schools.filter(s => s.idebFinal >= 6.5).sort((a, b) => b.idebFinal - a.idebFinal).slice(0, 10);
                    break;
                case 'bottom':
                    filteredData = mockData.schools.filter(s => s.idebFinal < 4.0).sort((a, b) => a.idebFinal - b.idebFinal).slice(0, 10);
                    break;
                case 'large':
                    filteredData = mockData.schools.filter(s => s.students >= 1000);
                    break;
                case 'small':
                    filteredData = mockData.schools.filter(s => s.students < 500);
                    break;
                case 'pei':
                    filteredData = mockData.schools.filter(s => s.classification === 'PEI');
                    break;
                case 'ee':
                    filteredData = mockData.schools.filter(s => s.classification === 'EE');
                    break;
                default:
                    filteredData = [...mockData.schools];
            }
            
            updateCharts();
            updateTable();
            updateStats();
        }

        function updateCharts() {
            // Atualizar dados dos gr√°ficos baseado nos filtros
            const classificationCount = filteredData.reduce((acc, school) => {
                acc[school.classification] = (acc[school.classification] || 0) + 1;
                return acc;
            }, {});

            charts.classification.data.datasets[0].data = [
                classificationCount.PEI || 0,
                classificationCount.EE || 0
            ];
            charts.classification.update();

            // Atualizar outros gr√°ficos...
        }

        function updateTable() {
            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = '';

            filteredData.forEach(school => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${school.name}</td>
                    <td>${school.classification}</td>
                    <td>${school.directorate}</td>
                    <td>${school.idebFinal}</td>
                    <td>${school.idebHigh}</td>
                    <td>${school.students.toLocaleString()}</td>
                    <td>${school.classes}</td>
                    <td>${school.classrooms}</td>
                    <td><span style="color: #28a745;">${school.status}</span></td>
                `;
                tbody.appendChild(row);
            });
        }

        function updateStats() {
            const avgIdeb = filteredData.reduce((sum, school) => sum + school.idebFinal, 0) / filteredData.length;
            const totalStudents = filteredData.reduce((sum, school) => sum + school.students, 0);

            document.getElementById('totalSchools').textContent = filteredData.length.toLocaleString();
            document.getElementById('avgIdeb').textContent = avgIdeb.toFixed(1);
            document.getElementById('totalStudents').textContent = (totalStudents / 1000).toFixed(0) + 'K';
        }

        function filterTable(searchTerm) {
            const rows = document.querySelectorAll('#tableBody tr');
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm.toLowerCase()) ? '' : 'none';
            });
        }

        function exportChart(chartId) {
            const canvas = document.getElementById(chartId);
            const link = document.createElement('a');
            link.download = `${chartId}.png`;
            link.href = canvas.toDataURL();
            link.click();
        }

        function toggleFullscreen(chartId) {
            const container = document.getElementById(chartId).closest('.chart-container');
            if (container.style.position === 'fixed') {
                container.style.position = 'relative';
                container.style.top = 'auto';
                container.style.left = 'auto';
                container.style.width = 'auto';
                container.style.height = 'auto';
                container.style.zIndex = 'auto';
            } else {
                container.style.position = 'fixed';
                container.style.top = '50%';
                container.style.left = '50%';
                container.style.transform = 'translate(-50%, -50%)';
                container.style.width = '80vw';
                container.style.height = '80vh';
                container.style.zIndex = '1000';
                container.style.backgroundColor = 'white';
            }
        }
    </script>
</body>
</html> 